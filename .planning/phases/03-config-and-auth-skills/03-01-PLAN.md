---
phase: 03-config-and-auth-skills
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - .agents/skills/nsyte-config/SKILL.md
autonomous: true
requirements:
  - CONF-01

must_haves:
  truths:
    - "Agent can learn how to read and modify nsyte project configuration using nsyte-config skill"
    - "Agent understands that nsyte config requires an interactive terminal (TTY)"
    - "Agent knows how to validate config without a TTY using nsyte validate"
    - "Agent can identify all config schema fields and their purposes"
  artifacts:
    - path: ".agents/skills/nsyte-config/SKILL.md"
      provides: "Complete config management skill body"
      contains: "nsyte config"
  key_links:
    - from: ".agents/skills/nsyte-config/SKILL.md"
      to: ".agents/skills/nsyte-concepts/references/nostr-concepts.md"
      via: "cross-reference for domain vocabulary"
      pattern: "nsyte-concepts"
    - from: ".agents/skills/nsyte-config/SKILL.md"
      to: ".agents/skills/nsyte-auth/SKILL.md"
      via: "cross-reference for bunkerPubkey field"
      pattern: "nsyte-auth"
---

<objective>
Write the complete nsyte-config skill body covering interactive TUI config editing and scriptable validation.

Purpose: An agent encountering nsyte configuration for the first time can read, modify, and validate `.nsite/config.json` settings — knowing which tool to use (TUI vs direct edit vs validate) depending on the execution context (interactive vs scripted).

Output: `.agents/skills/nsyte-config/SKILL.md` with full body content
</objective>

<execution_context>
@/home/sandwich/.claude/get-shit-done/workflows/execute-plan.md
@/home/sandwich/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-config-and-auth-skills/03-RESEARCH.md
@.agents/skills/nsyte-deploy/SKILL.md
@.agents/skills/nsyte-config/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write nsyte-config SKILL.md body</name>
  <files>.agents/skills/nsyte-config/SKILL.md</files>
  <action>
Replace the placeholder comment in `.agents/skills/nsyte-config/SKILL.md` with the full skill body. Preserve the existing frontmatter exactly (name and description fields). Follow the structural template established by `nsyte-deploy/SKILL.md` (Prerequisites → main sections → Troubleshooting).

The body MUST cover these sections:

**Prerequisites:**
- nsyte installed and in PATH (reference nsyte-setup skill)
- `.nsite/config.json` must exist (created by `nsyte init`)
- Reference nsyte-concepts for Nostr/Blossom domain vocabulary

**Interactive Config Editing (`nsyte config`):**
- State clearly: requires an interactive terminal (TTY). Cannot run in CI/scripts/pipes.
- Keyboard reference table from research (Navigation ↑/↓, Edit ENTER, Save s, Reset r, Help h, Quit q, Collapse ESC, Delete DEL/BACKSPACE)
- Note: `bunkerPubkey` field opens a bunker-selection overlay — do not edit this manually, use `nsyte bunker use` instead (reference nsyte-auth skill)

**Config Schema Reference:**
- Table of all config fields from the research, grouped:
  - Required: `relays` (array of wss:// URLs), `servers` (array of https:// URLs)
  - Auth: `bunkerPubkey` (64-char hex, set by `nsyte bunker use` only)
  - Site identity: `id` (null = root site kind 15128, non-empty = named site kind 35128), `title`, `description`
  - Routing: `fallback` (404 fallback HTML path)
  - Publishing: `publishProfile`, `publishRelayList`, `publishServerList` (booleans, root sites only), `publishAppHandler`
  - Gateway: `gatewayHostnames` (array, default ["nsite.lol"])
  - Profile: `profile` object (name, display_name, about, picture, banner, website, nip05, lud16, lud06)
  - App handler: `appHandler` object with required `kinds` array
  - Editor support: `$schema` URI
- Document validation rules: root sites with publishAppHandler:true need appHandler.id; publish* fields only for id=null/empty; publishProfile:true needs non-empty profile

**Scriptable Validation (`nsyte validate`):**
- Command: `nsyte validate` (alias: `nsyte val`)
- Flag: `--file /path/to/config.json` for non-default location
- Flag: `--schema` to show JSON Schema location for editor integration
- Exit codes: 0 = valid, 1 = invalid
- Example output for success and failure

**Programmatic Config Editing (no TTY):**
- When nsyte config cannot be used (CI, scripts), edit `.nsite/config.json` directly
- Always run `nsyte validate` after manual edits
- NEVER manually set bunkerPubkey — always use `nsyte bunker use` (reference nsyte-auth skill)

CRITICAL constraints:
- Do NOT include CI/CD deployment instructions (that is nsyte-ci territory)
- Do NOT include bunker connection/import/export steps (that is nsyte-auth territory)
- Keep under 200 lines for the body (not counting frontmatter)
- Use `---` horizontal rules as section dividers
- Use tables for flag and field references
- Cross-reference other skills by name where appropriate
  </action>
  <verify>
    <automated>wc -l .agents/skills/nsyte-config/SKILL.md | awk '{if ($1 > 5 && $1 < 210) print "PASS: " $1 " lines"; else print "FAIL: " $1 " lines"}'</automated>
    <manual>Verify body contains all required sections: Prerequisites, Interactive Config Editing, Config Schema Reference, Scriptable Validation, Programmatic Config Editing</manual>
  </verify>
  <done>nsyte-config/SKILL.md has a complete body covering interactive TUI editing, config schema reference, and scriptable validation. No CI/CD instructions present. No bunker setup steps present. Body is under 200 lines.</done>
</task>

<task type="auto">
  <name>Task 2: Validate skill structure and cross-references</name>
  <files>.agents/skills/nsyte-config/SKILL.md</files>
  <action>
Verify the completed nsyte-config SKILL.md:

1. Confirm frontmatter `name` field is exactly `nsyte-config` (byte-for-byte match with directory name)
2. Confirm no `nsyte login` references (that command does not exist — use `nsyte init`)
3. Confirm no `--nbunksec` flag references (use `--sec` per prior decisions)
4. Confirm the skill cross-references `nsyte-setup` (for installation), `nsyte-auth` (for bunker management), and `nsyte-concepts` (for domain vocabulary)
5. Confirm no CI/CD deployment patterns leaked into this skill (no `--non-interactive`, no `nsyte ci`, no GitHub Actions examples)
6. Confirm `bunkerPubkey` is documented as hex-only (not npub) and warns against manual editing

Fix any issues found during validation.
  </action>
  <verify>
    <automated>grep -c "nsyte login" .agents/skills/nsyte-config/SKILL.md | awk '{if ($1 == 0) print "PASS: no nsyte login"; else print "FAIL: found nsyte login"}'</automated>
    <manual>Verify cross-references to nsyte-setup, nsyte-auth, and nsyte-concepts are present</manual>
  </verify>
  <done>nsyte-config SKILL.md passes all validation checks: correct frontmatter name, no deprecated commands or flags, proper cross-references, no scope leakage into CI/auth territory</done>
</task>

</tasks>

<verification>
1. `.agents/skills/nsyte-config/SKILL.md` exists with complete body (not just frontmatter stub)
2. Body covers: Prerequisites, Interactive Config Editing, Config Schema Reference, Scriptable Validation, Programmatic Config Editing
3. No cross-contamination: no CI instructions, no bunker setup steps
4. Under 200 lines body content
5. Frontmatter name matches directory name exactly
</verification>

<success_criteria>
An agent reading nsyte-config SKILL.md can determine: (1) whether to use `nsyte config` TUI or direct JSON editing based on context, (2) what every config field means and accepts, (3) how to validate config changes, and (4) which other skills to consult for auth and CI concerns.
</success_criteria>

<output>
After completion, create `.planning/phases/03-config-and-auth-skills/03-01-SUMMARY.md`
</output>
